apiVersion: v1
kind: Service
metadata:
  name: '{{.LabID}}-service'
  namespace: devsarena
  labels:
    app: '{{.LabID}}'
spec:
  selector:
    app: '{{.LabID}}'
  ports:
{{- if eq .Language "react" }}
    # Port for the Vite dev server (React)
    - name: vite-dev
      port: 5173
      targetPort: 5173
      protocol: TCP
{{- else if eq .Language "node" }}
    # Port for Node.js applications
    - name: node
      port: 8000
      targetPort: 8000
      protocol: TCP
{{- else if eq .Language "node-express" }}
    # Port for Node-Express applications
    - name: node-express
      port: 4000
      targetPort: 4000
      protocol: TCP
{{- else }}
    # Default to React port
    - name: vite-dev
      port: 5173
      targetPort: 5173
      protocol: TCP
{{- end }}
    # WebSocket ports (always needed)
    - name: fs-ws
      port: 8081
      targetPort: 8081
      protocol: TCP
    - name: pty-ws
      port: 8082
      targetPort: 8082
      protocol: TCP
  type: ClusterIP